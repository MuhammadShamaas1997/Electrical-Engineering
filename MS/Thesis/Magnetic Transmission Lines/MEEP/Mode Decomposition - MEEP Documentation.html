<!DOCTYPE html>
<!-- saved from url=(0057)https://meep.readthedocs.io/en/latest/Mode_Decomposition/ -->
<html class=" js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths" lang="en" style=""><script async="" src="./Mode Decomposition - MEEP Documentation_files/analytics.js.download"></script><script type="text/javascript" charset="utf-8" id="zm-extension" src="chrome-extension://fdcgdnkidjaadafnichfpabhfomcebme/scripts/webrtc-patch.js" async=""></script><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="MEEP Developers">
  <link rel="shortcut icon" href="https://meep.readthedocs.io/en/latest/img/favicon.ico">
  <title>Mode Decomposition - MEEP Documentation</title>
  <link href="./Mode Decomposition - MEEP Documentation_files/css" rel="stylesheet" type="text/css">

  <link rel="stylesheet" href="./Mode Decomposition - MEEP Documentation_files/theme.css" type="text/css">
  <link rel="stylesheet" href="./Mode Decomposition - MEEP Documentation_files/theme_extra.css" type="text/css">
  <link rel="stylesheet" href="./Mode Decomposition - MEEP Documentation_files/highlight.css">
  <link href="./Mode Decomposition - MEEP Documentation_files/badge_only.css" rel="stylesheet">
  <link href="./Mode Decomposition - MEEP Documentation_files/readthedocs-doc-embed.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Mode Decomposition";
    var mkdocs_page_input_path = "Mode_Decomposition.md";
    var mkdocs_page_url = "/Mode_Decomposition/";
  </script>
  
  <script src="./Mode Decomposition - MEEP Documentation_files/jquery-2.1.1.min.js.download"></script>
  <script src="./Mode Decomposition - MEEP Documentation_files/modernizr-2.8.3.min.js.download"></script>
  <script type="text/javascript" src="./Mode Decomposition - MEEP Documentation_files/highlight.pack.js.download"></script> 
  
<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="mustache.min" src="./Mode Decomposition - MEEP Documentation_files/mustache.min.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="lunr.min" src="./Mode Decomposition - MEEP Documentation_files/lunr.min.js.download"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="text" src="./Mode Decomposition - MEEP Documentation_files/text.js.download"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><link href="./Mode Decomposition - MEEP Documentation_files/84.js.download" rel="preload" as="script"><script src="./Mode Decomposition - MEEP Documentation_files/84.js.download" type="text/javascript"></script><link href="./Mode Decomposition - MEEP Documentation_files/apu.php" rel="preload" as="script"><script src="./Mode Decomposition - MEEP Documentation_files/apu.php" type="text/javascript"></script><script type="text/javascript" src="./Mode Decomposition - MEEP Documentation_files/bc.js.download"></script><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body class="wy-body-for-nav" role="document"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="https://meep.readthedocs.io/en/latest/" class="icon icon-home"> MEEP Documentation</a>
        <div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://meep.readthedocs.io/en/latest/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs">
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="https://meep.readthedocs.io/en/latest/">Manual</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="https://meep.readthedocs.io/en/latest/Introduction/">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="https://meep.readthedocs.io/en/latest/Download/">Download</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="https://meep.readthedocs.io/en/latest/FAQ/">FAQ</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="https://meep.readthedocs.io/en/latest/Installation/">Installation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="https://meep.readthedocs.io/en/latest/Build_From_Source/">Build From Source</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="https://meep.readthedocs.io/en/latest/Acknowledgements/">Acknowledgements</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="https://meep.readthedocs.io/en/latest/License_and_Copyright/">License and Copyright</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Features</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Materials/">Materials</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Subpixel_Smoothing/">Subpixel Smoothing</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Exploiting_Symmetry/">Exploiting Symmetry</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Cylindrical_Coordinates/">Cylindrical Coordinates</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Perfectly_Matched_Layer/">Perfectly Matched Layers</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Parallel_Meep/">Parallel Meep</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Synchronizing_the_Magnetic_and_Electric_Fields/">Synchronizing the Magnetic and Electric Fields</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/">Mode Decomposition</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#theoretical-background">Theoretical Background</a></li>
    

    <li class="toctree-l3"><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#function-description">Function Description</a></li>
    

    <li class="toctree-l3"><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#normalization">Normalization</a></li>
    

    <li class="toctree-l3"><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#related-functions">Related Functions</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#computing-mpb-eigenmodes">Computing MPB Eigenmodes</a></li>
        
            <li><a class="toctree-l4" href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#working-with-mpb-eigenmodes">Working with MPB Eigenmodes</a></li>
        
            <li><a class="toctree-l4" href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#exporting-frequency-domain-fields">Exporting Frequency-Domain Fields</a></li>
        
            <li><a class="toctree-l4" href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#computing-overlap-integrals">Computing Overlap Integrals</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#how-mode-decomposition-works">How Mode Decomposition Works</a></li>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Field_Functions/">Field Functions</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/The_Run_Function_Is_Not_A_Loop/">The Run Function is Not a Loop</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Yee_Lattice/">Yee Lattice</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Units_and_Nonlinearity/">Units and Nonlinearity</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Python Interface</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_User_Interface/">User Interface</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Developer_Information/">Developer Information</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Basics/">Tutorial/Basics</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Ring_Resonator_in_Cylindrical_Coordinates/">Tutorial/Ring Resonator in Cylindrical Coordinates</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Resonant_Modes_and_Transmission_in_a_Waveguide_Cavity/">Tutorial/Resonant Modes and Transmission in a Waveguide Cavity</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Material_Dispersion/">Tutorial/Material Dispersion</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Third_Harmonic_Generation/">Tutorial/Third Harmonic Generation</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Near_to_Far_Field_Spectra/">Tutorial/Near-to-Far Field Spectra</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Local_Density_of_States/">Tutorial/Local Density of States</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Optical_Forces/">Tutorial/Optical Forces</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Gyrotropic_Media/">Tutorial/Gyrotropic Media</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Multilevel_Atomic_Susceptibility/">Tutorial/Multilevel Atomic Susceptibility</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Frequency_Domain_Solver/">Tutorial/Frequency-Domain Solver</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Eigenmode_Source/">Tutorial/Eigenmode Source</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Mode_Decomposition/">Tutorial/Mode Decomposition</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/GDSII_Import/">Tutorial/GDSII Import</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Python_Tutorials/AdjointSolver/">Tutorial/Adjoint Solver</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Scheme Interface</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_User_Interface/">User Interface</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Basics/">Tutorial/Basics</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Ring_Resonator_in_Cylindrical_Coordinates/">Tutorial/Ring Resonator in Cylindrical Coordinates</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Resonant_Modes_and_Transmission_in_a_Waveguide_Cavity/">Tutorial/Resonant Modes and Transmission in a Waveguide Cavity</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Material_Dispersion/">Tutorial/Material Dispersion</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Third_Harmonic_Generation/">Tutorial/Third Harmonic Generation</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Near_to_Far_Field_Spectra/">Tutorial/Near-to-Far Field Spectra</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Local_Density_of_States/">Tutorial/Local Density of States</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Optical_Forces/">Tutorial/Optical Forces</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Gyrotropic_Media/">Tutorial/Gyrotropic Media</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Multilevel_Atomic_Susceptibility/">Tutorial/Multilevel Atomic Susceptibility</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Frequency_Domain_Solver/">Tutorial/Frequency-Domain Solver</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Eigenmode_Source/">Tutorial/Eigenmode Source</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Mode_Decomposition/">Tutorial/Mode Decomposition</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Scheme_Tutorials/Casimir_Forces/">Tutorial/Casimir Forces</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Guile_and_Scheme_Information/">Guile and Scheme Information</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">C++ Interface</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/C++_Developer_Information/">Developer Information</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/Chunks_and_Symmetry/">Chunks and Symmetry</a>
                </li>
                <li class="">
                    
    <a class="" href="https://meep.readthedocs.io/en/latest/C++_Tutorial/">Tutorial/Basics</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    <div id="rtd-yqp7v22w" class="ethical-rtd ethical-dark-theme"><div class="ethical-sidebar"><div class="ethical-content"><a href="https://readthedocs.org/sustainability/click/305/CrQX3gXhOBRC/" rel="nofollow" target="_blank" class="ethical-image-link"><img src="./Mode Decomposition - MEEP Documentation_files/readthedocs-logo-fs8.png"></a><div class="ethical-text"><a href="https://readthedocs.org/sustainability/click/305/CrQX3gXhOBRC/" rel="nofollow" target="_blank">Private repos and priority support<br>Try Read the Docs for Business Today!</a></div></div><div class="ethical-callout"><small><em><a href="https://readthedocs.org/sustainability/advertising/">Sponsored</a><span> · </span><a href="https://docs.readthedocs.io/en/latest/ethical-advertising.html">Ads served ethically</a></em></small></div></div></div></nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="https://meep.readthedocs.io/en/latest/">MEEP Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="https://meep.readthedocs.io/en/latest/">Docs</a> »</li>
    
      
        
          <li>Features »</li>
        
      
    
    <li>Mode Decomposition</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/NanoComp/meep/edit/master/doc/docs/Mode_Decomposition.md" class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="mode-decomposition">Mode Decomposition</h1>
<p>Meep contains a feature to decompose arbitrary fields into a superposition of the harmonic modes of a given structure via its integration with the eigenmode solver <a href="https://mpb.readthedocs.io/">MPB</a>. This section provides an overview of the theory and implementation of this feature. Tutorial examples are provided in <a href="https://meep.readthedocs.io/en/latest/Python_Tutorials/Mode_Decomposition/">Tutorial/Mode Decomposition</a>.</p>
<div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#mode-decomposition">Mode Decomposition</a><ul>
<li><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#theoretical-background">Theoretical Background</a></li>
<li><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#function-description">Function Description</a></li>
<li><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#normalization">Normalization</a></li>
<li><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#related-functions">Related Functions</a><ul>
<li><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#computing-mpb-eigenmodes">Computing MPB Eigenmodes</a></li>
<li><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#working-with-mpb-eigenmodes">Working with MPB Eigenmodes</a></li>
<li><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#exporting-frequency-domain-fields">Exporting Frequency-Domain Fields</a></li>
<li><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#computing-overlap-integrals">Computing Overlap Integrals</a></li>
</ul>
</li>
<li><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition/#how-mode-decomposition-works">How Mode Decomposition Works</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="theoretical-background">Theoretical Background</h2>
<p>The theory underlying mode decomposition is described in Chapter 31 ("Modal methods for Maxwell's equations") of <a href="http://www.springer.com/us/book/9780412099502">Optical Waveguide Theory</a> by Snyder and Love.</p>
<p>Consider a waveguide with propagation axis along the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">x</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">x</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">x</script> direction and constant cross section in the transverse direction <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mrow" id="MJXp-Span-4"><span class="MJXp-munderover" id="MJXp-Span-5"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">→</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">ρ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">y</span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">z</span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-5"><span class="texatom" id="MathJax-Span-6"><span class="mrow" id="MathJax-Span-7"><span class="munderover" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 0.59em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.54em, 4.383em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.057em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.483em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.264em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main; padding-left: 0.27em;">=</span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main; padding-left: 0.27em;">(</span><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">\vec\rho=(y,z)</script>. For a given angular frequency ω we can solve for the eigenmodes of the structure. Thus, arbitrary fields of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-14"><span class="MJXp-mrow" id="MJXp-Span-15"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-16">E</span></span><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-18"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-19">r</span></span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">t</span><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-25">E</span></span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-27"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-28">r</span></span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-30"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-32" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-33">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">ω</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">t</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-17"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-18"><span class="texatom" id="MathJax-Span-19"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Main-bold;">E</span></span></span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-23"><span class="mrow" id="MathJax-Span-24"><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Main-bold;">r</span></span></span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">t</span><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main; padding-left: 0.27em;">=</span><span class="texatom" id="MathJax-Span-30" style="padding-left: 0.27em;"><span class="mrow" id="MathJax-Span-31"><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Main-bold;">E</span></span></span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-34"><span class="mrow" id="MathJax-Span-35"><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Main-bold;">r</span></span></span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-38"><span style="display: inline-block; position: relative; width: 2.033em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="texatom" id="MathJax-Span-40"><span class="mrow" id="MathJax-Span-41"><span class="mo" id="MathJax-Span-42" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-43" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-44" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ω</span><span class="mi" id="MathJax-Span-45" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">\mathbf{E}(\mathbf{r},t) = \mathbf{E}(\mathbf{r}) e^{-i\omega t}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-mrow" id="MJXp-Span-38"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-39">H</span></span><span class="MJXp-mo" id="MJXp-Span-40" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-42">r</span></span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">t</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-47"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-48">H</span></span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-50"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-51">r</span></span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-53"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-55" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-56">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">ω</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">t</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-46"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-47"><span class="texatom" id="MathJax-Span-48"><span class="mrow" id="MathJax-Span-49"><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Main-bold;">H</span></span></span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-52"><span class="mrow" id="MathJax-Span-53"><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Main-bold;">r</span></span></span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">t</span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main; padding-left: 0.27em;">=</span><span class="texatom" id="MathJax-Span-59" style="padding-left: 0.27em;"><span class="mrow" id="MathJax-Span-60"><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Main-bold;">H</span></span></span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-63"><span class="mrow" id="MathJax-Span-64"><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Main-bold;">r</span></span></span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-67"><span style="display: inline-block; position: relative; width: 2.033em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.483em;"><span class="texatom" id="MathJax-Span-69"><span class="mrow" id="MathJax-Span-70"><span class="mo" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Math-italic;">ω</span><span class="mi" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">\mathbf{H}(\mathbf{r},t) = \mathbf{H}(\mathbf{r}) e^{-i\omega t}</script> can be decomposed into a basis of these eigenmodes:</p>
<p>
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-60"><span class="MJXp-mrow" id="MJXp-Span-61"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-62">E</span></span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-64"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-65">r</span></span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-68"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-69">E</span></span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">x</span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-73"><span class="MJXp-munderover" id="MJXp-Span-74"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">→</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">ρ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-79"><span class=""><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-81" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">n</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-83"><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.162em;">{</span></span><span class="MJXp-msubsup" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86" style="margin-right: 0.05em;">α</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-88">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">n</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mrow" id="MJXp-Span-90" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-91">E</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-93">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-95"><span class="MJXp-munderover" id="MJXp-Span-96"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">→</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">ρ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-102" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-103">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">i</span><span class="MJXp-msubsup" id="MJXp-Span-105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-107" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111" style="margin-right: 0.05em;">α</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-113">−</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">n</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-114"><span class="MJXp-mrow" id="MJXp-Span-115" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-116">E</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-118">−</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-120"><span class="MJXp-munderover" id="MJXp-Span-121"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">→</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">ρ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-127" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-128">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">i</span><span class="MJXp-msubsup" id="MJXp-Span-130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-132" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-134" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.162em;">}</span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-75"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-76"><span class="texatom" id="MathJax-Span-77"><span class="mrow" id="MathJax-Span-78"><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Main-bold;">E</span></span></span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-81"><span class="mrow" id="MathJax-Span-82"><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Main-bold;">r</span></span></span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main; padding-left: 0.27em;">=</span><span class="texatom" id="MathJax-Span-86" style="padding-left: 0.27em;"><span class="mrow" id="MathJax-Span-87"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Main-bold;">E</span></span></span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-92" style="padding-left: 0.163em;"><span class="mrow" id="MathJax-Span-93"><span class="munderover" id="MathJax-Span-94"><span style="display: inline-block; position: relative; width: 0.59em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.54em, 4.383em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.057em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.483em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.264em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main; padding-left: 0.27em;">=</span><span class="munderover" id="MathJax-Span-99" style="padding-left: 0.27em;"><span style="display: inline-block; position: relative; width: 1.445em; height: 0px;"><span style="position: absolute; clip: rect(2.887em, 1001.39em, 4.597em, -999.997em); top: -4.004em; left: 0em;"><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.43em, 4.276em, -999.997em); top: -2.935em; left: 0.537em;"><span class="texatom" id="MathJax-Span-101"><span class="mrow" id="MathJax-Span-102"><span class="mi" id="MathJax-Span-103" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mrow" id="MathJax-Span-104" style="padding-left: 0.163em;"><span class="mo" id="MathJax-Span-105" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">{</span></span><span class="mrow" id="MathJax-Span-106"><span class="msubsup" id="MathJax-Span-107"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.59em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.421em, 1000.64em, 4.223em, -999.997em); top: -4.431em; left: 0.644em;"><span class="mo" id="MathJax-Span-109" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.843em; left: 0.644em;"><span class="mi" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.75em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="texatom" id="MathJax-Span-112"><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Main-bold;">E</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.421em, 1000.64em, 4.223em, -999.997em); top: -4.431em; left: 0.751em;"><span class="mo" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.737em; left: 0.751em;"><span class="mi" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-118"><span class="mrow" id="MathJax-Span-119"><span class="munderover" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 0.59em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.54em, 4.383em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.057em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.483em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.264em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-124"><span style="display: inline-block; position: relative; width: 2.513em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.483em;"><span class="texatom" id="MathJax-Span-126"><span class="mrow" id="MathJax-Span-127"><span class="mo" id="MathJax-Span-128" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-129" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="msubsup" id="MathJax-Span-130"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.33em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.377em;"><span class="mi" id="MathJax-Span-132" style="font-size: 50%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mi" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main; padding-left: 0.216em;">+</span><span class="msubsup" id="MathJax-Span-135" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.59em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.421em, 1000.64em, 4.223em, -999.997em); top: -4.431em; left: 0.644em;"><span class="mo" id="MathJax-Span-137" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.843em; left: 0.644em;"><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-139"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.75em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="texatom" id="MathJax-Span-140"><span class="mrow" id="MathJax-Span-141"><span class="mi" id="MathJax-Span-142" style="font-family: MathJax_Main-bold;">E</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.421em, 1000.64em, 4.223em, -999.997em); top: -4.431em; left: 0.751em;"><span class="mo" id="MathJax-Span-143" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.737em; left: 0.751em;"><span class="mi" id="MathJax-Span-144" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-146"><span class="mrow" id="MathJax-Span-147"><span class="munderover" id="MathJax-Span-148"><span style="display: inline-block; position: relative; width: 0.59em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.54em, 4.383em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.057em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.483em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.264em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-152"><span style="display: inline-block; position: relative; width: 2.513em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.483em;"><span class="texatom" id="MathJax-Span-154"><span class="mrow" id="MathJax-Span-155"><span class="mo" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-157" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="msubsup" id="MathJax-Span-158"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.33em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-159" style="font-size: 70.7%; font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.377em;"><span class="mi" id="MathJax-Span-160" style="font-size: 50%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mi" id="MathJax-Span-161" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-162" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">}</span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">
   \mathbf{E}(\mathbf{r}) = 
   \mathbf{E}(x,\vec{\rho}) =
   \sum_{n} \left\{   \alpha^+_n \mathbf E^+_n(\vec \rho)e^{+i\beta_n x}
                    + \alpha^-_n \mathbf E^-_n(\vec \rho)e^{-i\beta_n x}
            \right\}
</script>
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-135"><span class="MJXp-mrow" id="MJXp-Span-136"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-137">H</span></span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-139"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-140">r</span></span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-142" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-143"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-144">H</span></span><span class="MJXp-mo" id="MJXp-Span-145" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">x</span><span class="MJXp-mo" id="MJXp-Span-147" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-148"><span class="MJXp-munderover" id="MJXp-Span-149"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">→</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">ρ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-152" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-154"><span class=""><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-156" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">n</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-158"><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.162em;">{</span></span><span class="MJXp-msubsup" id="MJXp-Span-160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161" style="margin-right: 0.05em;">α</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-163">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">n</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-164"><span class="MJXp-mrow" id="MJXp-Span-165" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-166">H</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-168">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-169" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-170"><span class="MJXp-munderover" id="MJXp-Span-171"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">→</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">ρ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-177" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-178">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">i</span><span class="MJXp-msubsup" id="MJXp-Span-180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-182" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186" style="margin-right: 0.05em;">α</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-188">−</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">n</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-189"><span class="MJXp-mrow" id="MJXp-Span-190" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-191">H</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-193">−</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-195"><span class="MJXp-munderover" id="MJXp-Span-196"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">→</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">ρ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-202" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-203">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">i</span><span class="MJXp-msubsup" id="MJXp-Span-205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206" style="margin-right: 0.05em;">β</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-207" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.162em;">}</span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-163"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-164"><span class="texatom" id="MathJax-Span-165"><span class="mrow" id="MathJax-Span-166"><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Main-bold;">H</span></span></span><span class="mo" id="MathJax-Span-168" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-169"><span class="mrow" id="MathJax-Span-170"><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Main-bold;">r</span></span></span><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-173" style="font-family: MathJax_Main; padding-left: 0.27em;">=</span><span class="texatom" id="MathJax-Span-174" style="padding-left: 0.27em;"><span class="mrow" id="MathJax-Span-175"><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Main-bold;">H</span></span></span><span class="mo" id="MathJax-Span-177" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-180" style="padding-left: 0.163em;"><span class="mrow" id="MathJax-Span-181"><span class="munderover" id="MathJax-Span-182"><span style="display: inline-block; position: relative; width: 0.59em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.54em, 4.383em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-183" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.057em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.483em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-184" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.264em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-185" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-186" style="font-family: MathJax_Main; padding-left: 0.27em;">=</span><span class="munderover" id="MathJax-Span-187" style="padding-left: 0.27em;"><span style="display: inline-block; position: relative; width: 1.445em; height: 0px;"><span style="position: absolute; clip: rect(2.887em, 1001.39em, 4.597em, -999.997em); top: -4.004em; left: 0em;"><span class="mo" id="MathJax-Span-188" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.43em, 4.276em, -999.997em); top: -2.935em; left: 0.537em;"><span class="texatom" id="MathJax-Span-189"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mrow" id="MathJax-Span-192" style="padding-left: 0.163em;"><span class="mo" id="MathJax-Span-193" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">{</span></span><span class="mrow" id="MathJax-Span-194"><span class="msubsup" id="MathJax-Span-195"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.59em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.421em, 1000.64em, 4.223em, -999.997em); top: -4.431em; left: 0.644em;"><span class="mo" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.843em; left: 0.644em;"><span class="mi" id="MathJax-Span-198" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-199"><span style="display: inline-block; position: relative; width: 1.552em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.86em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="texatom" id="MathJax-Span-200"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202" style="font-family: MathJax_Main-bold;">H</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.421em, 1000.64em, 4.223em, -999.997em); top: -4.431em; left: 0.911em;"><span class="mo" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.737em; left: 0.911em;"><span class="mi" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-206"><span class="mrow" id="MathJax-Span-207"><span class="munderover" id="MathJax-Span-208"><span style="display: inline-block; position: relative; width: 0.59em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.54em, 4.383em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.057em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.483em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-210" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.264em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-211" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-212"><span style="display: inline-block; position: relative; width: 2.513em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.483em;"><span class="texatom" id="MathJax-Span-214"><span class="mrow" id="MathJax-Span-215"><span class="mo" id="MathJax-Span-216" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-217" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="msubsup" id="MathJax-Span-218"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.33em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-219" style="font-size: 70.7%; font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.377em;"><span class="mi" id="MathJax-Span-220" style="font-size: 50%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mi" id="MathJax-Span-221" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mo" id="MathJax-Span-222" style="font-family: MathJax_Main; padding-left: 0.216em;">+</span><span class="msubsup" id="MathJax-Span-223" style="padding-left: 0.216em;"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.59em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.421em, 1000.64em, 4.223em, -999.997em); top: -4.431em; left: 0.644em;"><span class="mo" id="MathJax-Span-225" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.843em; left: 0.644em;"><span class="mi" id="MathJax-Span-226" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-227"><span style="display: inline-block; position: relative; width: 1.552em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.86em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="texatom" id="MathJax-Span-228"><span class="mrow" id="MathJax-Span-229"><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Main-bold;">H</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.421em, 1000.64em, 4.223em, -999.997em); top: -4.431em; left: 0.911em;"><span class="mo" id="MathJax-Span-231" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.737em; left: 0.911em;"><span class="mi" id="MathJax-Span-232" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-234"><span class="mrow" id="MathJax-Span-235"><span class="munderover" id="MathJax-Span-236"><span style="display: inline-block; position: relative; width: 0.59em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.54em, 4.383em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math-italic;">ρ</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.057em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.483em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.264em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-240"><span style="display: inline-block; position: relative; width: 2.513em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-241" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.483em;"><span class="texatom" id="MathJax-Span-242"><span class="mrow" id="MathJax-Span-243"><span class="mo" id="MathJax-Span-244" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-245" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="msubsup" id="MathJax-Span-246"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.33em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-247" style="font-size: 70.7%; font-family: MathJax_Math-italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.377em;"><span class="mi" id="MathJax-Span-248" style="font-size: 50%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mi" id="MathJax-Span-249" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-250" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">}</span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-6">
   \mathbf{H}(\mathbf{r}) = 
   \mathbf{H}(x,\vec{\rho}) =
   \sum_{n} \left\{   \alpha^+_n \mathbf H^+_n(\vec \rho)e^{+i\beta_n x}
                    + \alpha^-_n \mathbf H^-_n(\vec \rho)e^{-i\beta_n x}
            \right\}
</script>
</p>
<p>β<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-210"><span class="MJXp-msubsup" id="MJXp-Span-211"><span class="MJXp-mi" id="MJXp-Span-212" style="margin-right: 0.05em;"></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-213" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-251"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-252"><span class="msubsup" id="MathJax-Span-253"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px;"><span style="position: absolute; clip: rect(3.849em, 1000em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-254"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -3.843em; left: 0em;"><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">_n</script> are the propagation wavevectors and α<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-214"><span class="MJXp-msubsup" id="MJXp-Span-215"><span class="MJXp-mi" id="MJXp-Span-216" style="margin-right: 0.05em;"></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-218"><span class="MJXp-mo" id="MJXp-Span-219">±</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">n</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-256"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-257"><span class="msubsup" id="MathJax-Span-258"><span style="display: inline-block; position: relative; width: 0.644em; height: 0px;"><span style="position: absolute; clip: rect(3.849em, 1000em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-259"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.64em, 4.169em, -999.997em); top: -4.324em; left: 0em;"><span class="texatom" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="mo" id="MathJax-Span-262" style="font-size: 70.7%; font-family: MathJax_Main;">±</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.843em; left: 0em;"><span class="mi" id="MathJax-Span-263" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">^{\pm}_n</script> are the basis coefficients. Mode decomposition involves solving for these unknown quantities. The following steps are involved in the computation:</p>
<ol>
<li>
<p>In Meep, compute the Fourier-transformed fields <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-220"><span class="MJXp-mrow" id="MJXp-Span-221"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-222">E</span></span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-224"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-225">r</span></span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-264"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-265"><span class="texatom" id="MathJax-Span-266"><span class="mrow" id="MathJax-Span-267"><span class="mi" id="MathJax-Span-268" style="font-family: MathJax_Main-bold;">E</span></span></span><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-270"><span class="mrow" id="MathJax-Span-271"><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Main-bold;">r</span></span></span><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">\mathbf{E}(\mathbf{r})</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-227"><span class="MJXp-mrow" id="MJXp-Span-228"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-229">H</span></span><span class="MJXp-mo" id="MJXp-Span-230" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-231"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-232">r</span></span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-274"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-275"><span class="texatom" id="MathJax-Span-276"><span class="mrow" id="MathJax-Span-277"><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Main-bold;">H</span></span></span><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-280"><span class="mrow" id="MathJax-Span-281"><span class="mi" id="MathJax-Span-282" style="font-family: MathJax_Main-bold;">r</span></span></span><span class="mo" id="MathJax-Span-283" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">\mathbf{H}(\mathbf{r})</script> on a surface which is transverse to the waveguide and stored in a <code>dft_flux</code> object.</p>
</li>
<li>
<p>In MPB, compute the eigenmodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-234"><span class="MJXp-msubsup" id="MJXp-Span-235"><span class="MJXp-mrow" id="MJXp-Span-236" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-237">E</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-239">±</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">n</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-284"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-285"><span class="msubsup" id="MathJax-Span-286"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.75em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="texatom" id="MathJax-Span-287"><span class="mrow" id="MathJax-Span-288"><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Main-bold;">E</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.64em, 4.169em, -999.997em); top: -4.431em; left: 0.751em;"><span class="mo" id="MathJax-Span-290" style="font-size: 70.7%; font-family: MathJax_Main;">±</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.737em; left: 0.751em;"><span class="mi" id="MathJax-Span-291" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">\mathbf{E}^\pm_n</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-240"><span class="MJXp-msubsup" id="MJXp-Span-241"><span class="MJXp-mrow" id="MJXp-Span-242" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-243">H</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-245">±</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">n</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-292"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-293"><span class="msubsup" id="MathJax-Span-294"><span style="display: inline-block; position: relative; width: 1.552em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.86em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="texatom" id="MathJax-Span-295"><span class="mrow" id="MathJax-Span-296"><span class="mi" id="MathJax-Span-297" style="font-family: MathJax_Main-bold;">H</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.64em, 4.169em, -999.997em); top: -4.431em; left: 0.911em;"><span class="mo" id="MathJax-Span-298" style="font-size: 70.7%; font-family: MathJax_Main;">±</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.737em; left: 0.911em;"><span class="mi" id="MathJax-Span-299" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">\mathbf{H}^\pm_n</script> as well as the propagation wavevectors β<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-246"><span class="MJXp-msubsup" id="MJXp-Span-247"><span class="MJXp-mi" id="MJXp-Span-248" style="margin-right: 0.05em;"></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-249" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-300"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-301"><span class="msubsup" id="MathJax-Span-302"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px;"><span style="position: absolute; clip: rect(3.849em, 1000em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-303"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -3.843em; left: 0em;"><span class="mi" id="MathJax-Span-304" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">_n</script> for the same cross-sectional structure.</p>
</li>
<li>
<p>Compute the coefficients α<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-msubsup" id="MJXp-Span-251"><span class="MJXp-mi" id="MJXp-Span-252" style="margin-right: 0.05em;"></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-254">±</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">n</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-305"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-306"><span class="msubsup" id="MathJax-Span-307"><span style="display: inline-block; position: relative; width: 0.644em; height: 0px;"><span style="position: absolute; clip: rect(3.849em, 1000em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-308"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.64em, 4.169em, -999.997em); top: -4.324em; left: 0em;"><span class="mo" id="MathJax-Span-309" style="font-size: 70.7%; font-family: MathJax_Main;">±</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.843em; left: 0em;"><span class="mi" id="MathJax-Span-310" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">_n^\pm</script> for any number of eigenmodes n=1,2,....</p>
</li>
</ol>
<p>This is all done automatically in Meep using the <code>get_eigenmode_coefficients</code> routine.</p>
<h2 id="function-description">Function Description</h2>
<p>The mode-decomposition feature is available via the <code>meep::fields::get_eigenmode_coefficients</code> function callable from Python or C++. This function makes use of several lower-level functions which are described in more detail below. The C++ header for this function is:</p>
<pre><code class="c++ hljs cpp"><span class="hljs-keyword">void</span> fields::get_eigenmode_coefficients(dft_flux flux,
                                        <span class="hljs-keyword">const</span> volume &amp;eig_vol,
                                        <span class="hljs-keyword">int</span> *bands,
                                        <span class="hljs-keyword">int</span> num_bands,
                                        <span class="hljs-keyword">int</span> parity,
                                        <span class="hljs-keyword">double</span> eig_resolution,
                                        <span class="hljs-keyword">double</span> eigensolver_tol,
                                        <span class="hljs-built_in">std</span>::<span class="hljs-keyword">complex</span>&lt;<span class="hljs-keyword">double</span>&gt; *coeffs,
                                        <span class="hljs-keyword">double</span> *vgrp,
                                        kpoint_func user_kpoint_func,
                                        <span class="hljs-keyword">void</span> *user_kpoint_data,
                                        vec *kdom_list,
                                        <span class="hljs-keyword">bool</span> verbose)
</code></pre>

<p>The following are the parameters:</p>
<ul>
<li>
<p><code>flux</code> is a <code>dft_flux</code> object containing the frequency-domain fields on a cross-sectional slice perpendicular to the waveguide axis</p>
</li>
<li>
<p><code>eig_vol</code> is the <code>volume</code> passed to <a href="https://mpb.readthedocs.io/">MPB</a> for the eigenmode calculation. In most cases this will simply be the volume over which the frequency-domain fields are tabulated (i.e. <code>flux.where</code>).</p>
</li>
<li>
<p><code>bands</code> is an array of integers corresponding to the mode indices (equivalent to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-311"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-312"><span class="mi" id="MathJax-Span-313" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">n</script> in the two formulas above)</p>
</li>
<li>
<p><code>num_bands</code> is the length of the <code>bands</code> array</p>
</li>
<li>
<p><code>parity</code> is the parity of the mode to calculate, assuming the structure has <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-314"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-315"><span class="mi" id="MathJax-Span-316" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">z</script> and/or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-317"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-318"><span class="mi" id="MathJax-Span-319" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">y</script> mirror symmetry in the source region. If the structure has both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">y</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-320"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-321"><span class="mi" id="MathJax-Span-322" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">y</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">z</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-323"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-324"><span class="mi" id="MathJax-Span-325" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">z</script> mirror symmetry, you can combine more than one of these, e.g. <code>ODD_Z+EVEN_Y</code>. This is especially useful in 2d simulations to restrict yourself to a desired polarization</p>
</li>
<li>
<p><code>eig_resolution</code> is the spatial resolution to use in MPB for the eigenmode calculations</p>
</li>
<li>
<p><code>eigensolver_tol</code> is the tolerance to use in the MPB eigensolver. MPB terminates when the eigenvalues stop changing by less than this fractional tolerance</p>
</li>
<li>
<p><code>coeffs</code> is a user-allocated array of type <code>std::complex&lt;double&gt;</code> (shortened hereafter to <code>cdouble</code>) of length <code>2*num_freqs*num_bands</code> where <code>num_freqs</code> is the number of frequencies stored in the <code>flux</code> object (equivalent to <code>flux-&gt;Nfreq</code>) and <code>num_bands</code> is the length of the <code>bands</code> input array. The expansion coefficients for the mode with frequency <code>nf</code> and band index <code>nb</code>  are stored sequentially as α<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-265"><span class="MJXp-msubsup" id="MJXp-Span-266"><span class="MJXp-mi" id="MJXp-Span-267" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-268" style="vertical-align: 0.5em;">+</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-326"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-327"><span class="msubsup" id="MathJax-Span-328"><span style="display: inline-block; position: relative; width: 0.644em; height: 0px;"><span style="position: absolute; clip: rect(3.849em, 1000em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-329"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0em;"><span class="mo" id="MathJax-Span-330" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">^+</script>, α<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-269"><span class="MJXp-msubsup" id="MJXp-Span-270"><span class="MJXp-mi" id="MJXp-Span-271" style="margin-right: 0.05em;"></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-272" style="vertical-align: 0.5em;">−</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-331"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-332"><span class="msubsup" id="MathJax-Span-333"><span style="display: inline-block; position: relative; width: 0.644em; height: 0px;"><span style="position: absolute; clip: rect(3.849em, 1000em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-334"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.378em; left: 0em;"><span class="mo" id="MathJax-Span-335" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">^-</script> starting at slot <code>2*nb*num_freqs+nf</code> of this array</p>
</li>
<li>
<p><code>vgrp</code> is an optional user-allocated <code>double</code> array of length <code>num_freqs*num_bands.</code> On return, <code>vgrp[nb*num_freqs + nf]</code> is the group velocity of the mode with frequency <code>nf</code> and band index <code>nb.</code> If you do not need this information, simply pass <code>NULL</code> for this parameter.</p>
</li>
<li>
<p><code>user_kpoint_func</code> is an optional function you supply to provide an initial guess of the wavevector of a mode with given frequency and band index having the following prototype:</p>
</li>
<li>
<p><code>verbose</code> controls the verbosity of <code>get_eigenmode</code>. Defaults to <code>false</code>.</p>
</li>
</ul>
<pre><code class="c++ hljs cpp">vec (*kpoint_func)(<span class="hljs-keyword">double</span> freq, <span class="hljs-keyword">int</span> mode, <span class="hljs-keyword">void</span> *user_data);
</code></pre>

<ul>
<li>
<p><code>user_kpoint_data</code> is the user data passed to the <code>user_kpoint_func</code></p>
</li>
<li>
<p><code>kdom_list</code> is a user allocated array of <code>meep::vec</code> objects of length (<code>num_bands</code> * <code>num_freqs</code>). If non-null, this array is filled in with the wavevectors of the dominant planewave in the Fourier series expansion for each band from 1 to (<code>num_bands</code> * <code>num_freqs</code>). <code>kdom_list[nb*num_freqs + nf]</code> is the dominant planewave of the mode with frequency <code>nf</code> and band index <code>nb</code>. (Defaults to <code>NULL</code>.)  This is especially useful for interpreting the modes computed in a uniform medium, because those modes are exactly planewaves proportional to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">p</span><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-278">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">π</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">i</span><span class="MJXp-mrow" id="MJXp-Span-281"><span class="MJXp-mi" id="MJXp-Span-282">k</span><span class="MJXp-mi" id="MJXp-Span-283">d</span><span class="MJXp-mi" id="MJXp-Span-284">o</span><span class="MJXp-mi" id="MJXp-Span-285">m</span></span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-287"><span class="MJXp-munderover" id="MJXp-Span-288"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-290" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">→</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">x</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-291" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-336"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-337"><span class="mi" id="MathJax-Span-338" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-340" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-341" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-342" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math-italic;">i</span><span class="texatom" id="MathJax-Span-345"><span class="mrow" id="MathJax-Span-346"><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Main;">k</span><span class="mi" id="MathJax-Span-348" style="font-family: MathJax_Main;">d</span><span class="mi" id="MathJax-Span-349" style="font-family: MathJax_Main;">o</span><span class="mi" id="MathJax-Span-350" style="font-family: MathJax_Main;">m</span></span></span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main; padding-left: 0.216em;">⋅</span><span class="texatom" id="MathJax-Span-352" style="padding-left: 0.216em;"><span class="mrow" id="MathJax-Span-353"><span class="munderover" id="MathJax-Span-354"><span style="display: inline-block; position: relative; width: 0.59em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.54em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-355" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.057em; left: 0.11em;"><span style="height: 0em; vertical-align: 0em; width: 0.483em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-356" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.264em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-357" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">exp(2\pi i \mathrm{kdom}\cdot \vec{x})</script> where <code>kdom</code> is the wavevector.</p>
</li>
</ul>
<pre><code class="c++ hljs cpp"> <span class="hljs-keyword">int</span> num_bands = bands.size();
 <span class="hljs-keyword">int</span> num_freqs = Flux-&gt;Nfreq;

 <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;cdouble&gt; coeffs(<span class="hljs-number">2</span>*num_bands*num_freqs);
 f.get_eigenmode_coefficients(...);

 <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> nb=<span class="hljs-number">0</span>; nb&lt;num_bands; nb++)
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> nf=<span class="hljs-number">0</span>; nf&lt;num_freqs++; nf++)
   { 
     <span class="hljs-comment">// get coefficients of forward- and backward-traveling</span>
     <span class="hljs-comment">// waves in eigenmode bands[nb] at frequency #nf</span>
     cdouble AlphaPlus = coeffs[<span class="hljs-number">2</span>*nb*num_freqs+nf+<span class="hljs-number">0</span>];
     cdouble AlphaMinus = coeffs[<span class="hljs-number">2</span>*nb*num_freqs+nf+<span class="hljs-number">1</span>];
     ...
</code></pre>

<h2 id="normalization">Normalization</h2>
<p>The α coefficients computed by <code>get_eigenmode_coefficients</code> are normalized such that their squared magnitude equals the power carried by the corresponding eigenmode:</p>
<p>
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-292"><span class="MJXp-mrow" id="MJXp-Span-293"><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296" style="margin-right: 0.05em;">α</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-298">±</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">n</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-299"><span class="MJXp-mrow" id="MJXp-Span-300" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-302" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-307">±</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">n</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-358"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-359"><span class="texatom" id="MathJax-Span-360"><span class="mrow" id="MathJax-Span-361"><span class="mo" id="MathJax-Span-362" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-363"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(3.421em, 1000.59em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.64em, 4.169em, -999.997em); top: -4.324em; left: 0.644em;"><span class="mo" id="MathJax-Span-365" style="font-size: 70.7%; font-family: MathJax_Main;">±</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.843em; left: 0.644em;"><span class="mi" id="MathJax-Span-366" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-367"><span style="display: inline-block; position: relative; width: 0.697em; height: 0px;"><span style="position: absolute; clip: rect(3.101em, 1000.16em, 4.436em, -999.997em); top: -4.004em; left: 0em;"><span class="texatom" id="MathJax-Span-368"><span class="mrow" id="MathJax-Span-369"><span class="mo" id="MathJax-Span-370" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -4.485em; left: 0.27em;"><span class="mn" id="MathJax-Span-371" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mo" id="MathJax-Span-372" style="font-family: MathJax_Main; padding-left: 0.27em;">=</span><span class="msubsup" id="MathJax-Span-373" style="padding-left: 0.27em;"><span style="display: inline-block; position: relative; width: 1.445em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.75em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-374" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.64em, 4.169em, -999.997em); top: -4.324em; left: 0.857em;"><span class="mo" id="MathJax-Span-375" style="font-size: 70.7%; font-family: MathJax_Main;">±</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.843em; left: 0.644em;"><span class="mi" id="MathJax-Span-376" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-23">|\alpha_n^\pm|^2 = P_n^\pm</script>
</p>
<p>where P<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-308"><span class="MJXp-msubsup" id="MJXp-Span-309"><span class="MJXp-mi" id="MJXp-Span-310" style="margin-right: 0.05em;"></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-312">±</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">n</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-377"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-378"><span class="msubsup" id="MathJax-Span-379"><span style="display: inline-block; position: relative; width: 0.644em; height: 0px;"><span style="position: absolute; clip: rect(3.849em, 1000em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-380"></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.64em, 4.169em, -999.997em); top: -4.324em; left: 0em;"><span class="mo" id="MathJax-Span-381" style="font-size: 70.7%; font-family: MathJax_Main;">±</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.843em; left: 0em;"><span class="mi" id="MathJax-Span-382" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">_n^\pm</script> is the power carried by the traveling eigenmode <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-383"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-384"><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">n</script> in the forward (+) or backward (-) direction. This is discussed in more detail below.</p>
<h2 id="related-functions">Related Functions</h2>
<p>Besides <code>get_eigenmode_coefficients,</code> there are a few computational routines in <code>libmeep</code> that you may find useful for problems like those considered above.</p>
<h3 id="computing-mpb-eigenmodes">Computing MPB Eigenmodes</h3>
<pre><code class="hljs cpp">  <span class="hljs-keyword">void</span> *fields::get_eigenmode(<span class="hljs-keyword">double</span> &amp;omega,
                              direction d, <span class="hljs-keyword">const</span> volume &amp;where,
                              <span class="hljs-keyword">const</span> volume &amp;eig_vol,
                              <span class="hljs-keyword">int</span> band_num,
                              <span class="hljs-keyword">const</span> vec &amp;kpoint, <span class="hljs-keyword">bool</span> match_frequency,
                              <span class="hljs-keyword">int</span> parity,
                              <span class="hljs-keyword">double</span> resolution,
                              <span class="hljs-keyword">double</span> eigensolver_tol,
                              <span class="hljs-keyword">bool</span> verbose,
                              <span class="hljs-keyword">double</span> *kdom);
</code></pre>

<p>Calls MPB to compute the <code>band_num</code>th eigenmode at frequency <code>omega</code> for the portion of your geometry lying in <code>where</code> which is typically a cross-sectional slice of a waveguide. <code>kpoint</code> is an initial starting guess for what the propagation vector of the waveguide mode will be. <code>kdom</code>, if non-NULL and length 3, is filled in with the dominant planewave for the current band (see above). This is implemented in <a href="https://github.com/NanoComp/meep/blob/master/src/mpb.cpp#L215-L537">mpb.cpp</a>.</p>
<h3 id="working-with-mpb-eigenmodes">Working with MPB Eigenmodes</h3>
<p>The return value of <code>get_eigenmode</code> is an <a href="https://en.wikipedia.org/wiki/Opaque_pointer">opaque pointer</a> to a data structure storing information about the computed eigenmode, which may be passed to the following routines:</p>
<pre><code class="hljs cpp"><span class="hljs-comment">// get a single component of the eigenmode field at a given point in space</span>
<span class="hljs-built_in">std</span>::<span class="hljs-keyword">complex</span>&lt;<span class="hljs-keyword">double</span>&gt; eigenmode_amplitude(<span class="hljs-keyword">const</span> vec &amp;p, <span class="hljs-keyword">void</span> *vedata, component c);

<span class="hljs-comment">// get the group velocity of the eigenmode </span>
<span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">get_group_velocity</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *vedata)</span></span>;

<span class="hljs-comment">// free all memory associated with the eigenmode</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">destroy_eigenmode_data</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *vedata)</span></span>;
</code></pre>

<p>These functions are implemented in <a href="https://github.com/NanoComp/meep/blob/master/src/mpb.cpp">src/mpb.cpp</a>.</p>
<h3 id="exporting-frequency-domain-fields">Exporting Frequency-Domain Fields</h3>
<pre><code class="hljs java">  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">output_dft</span><span class="hljs-params">(dft_flux flux, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *HDF5FileName)</span></span>;

  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">output_mode_fields</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *mode_data, dft_flux flux, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *HDF5FileName)</span></span>;
</code></pre>

<p><code>output_dft</code> exports the components of the frequency-domain fields stored in <code>flux</code> to an HDF5 file with the given filename In general, <code>flux</code> will store data for fields at multiple frequencies.</p>
<p><code>output_mode_fields</code> is similar, but instead exports the components of the eigenmode described by <code>mode_data</code> which should be the return value of a call to <code>get_eigenmode</code>.</p>
<p>These functions are implemented in <a href="https://github.com/NanoComp/meep/blob/master/src/dft.cpp#L982-L1021">src/dft.cpp</a>.</p>
<h3 id="computing-overlap-integrals">Computing Overlap Integrals</h3>
<pre><code class="hljs cpp">  <span class="hljs-built_in">std</span>::<span class="hljs-keyword">complex</span>&lt;<span class="hljs-keyword">double</span>&gt; get_mode_flux_overlap(<span class="hljs-keyword">void</span> *mode_data, 
                                             dft_flux *flux, 
                                             <span class="hljs-keyword">int</span> num_freq, 
                                             <span class="hljs-built_in">std</span>::<span class="hljs-keyword">complex</span>&lt;<span class="hljs-keyword">double</span>&gt;overlap[<span class="hljs-number">2</span>]);

  <span class="hljs-built_in">std</span>::<span class="hljs-keyword">complex</span>&lt;<span class="hljs-keyword">double</span>&gt; get_mode_mode_overlap(<span class="hljs-keyword">void</span> *mode1_data,
                                             <span class="hljs-keyword">void</span> *mode2_data,
                                             dft_flux *flux,
                                             <span class="hljs-built_in">std</span>::<span class="hljs-keyword">complex</span>&lt;<span class="hljs-keyword">double</span>&gt;overlap[<span class="hljs-number">2</span>]);
</code></pre>

<p><code>get_mode_flux_overlap</code> computes the overlap integral between the eigenmode described by <code>mode_data</code> and the fields stored in <code>flux</code> for the <code>num_freq</code>th stored frequency, where <code>num_freq</code> ranges from 0 to <code>flux-&gt;Nfreq-1</code>. <code>mode_data</code> should be the return value of a previous call to <code>get_eigenmode.</code></p>
<p><code>get_mode_mode_overlap</code> is similar, but computes the overlap integral between two eigenmodes. <code>mode1_data</code> and <code>mode2_data</code> may be identical, in which case you get the inner product of the mode with itself. This should equal the group velocity of the mode based on the MPB's normalization convention.</p>
<p>These functions are implemented in <a href="https://github.com/NanoComp/meep/blob/master/src/dft.cpp#L1078-L1086">src/dft.cpp</a>.</p>
<h2 id="how-mode-decomposition-works">How Mode Decomposition Works</h2>
<p>The theoretical basis of the mode-decomposition algorithm is the orthogonality relation satisfied by the normal modes:</p>
<p>
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-315"><span class="MJXp-mrow" id="MJXp-Span-316"><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.13em;">⟨</span></span><span class="MJXp-msubsup" id="MJXp-Span-318"><span class="MJXp-mrow" id="MJXp-Span-319" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-320">E</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">σ</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">m</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.04em;">|</span></span></span><span class="MJXp-mrow" id="MJXp-Span-325"><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-327"><span class="MJXp-mrow" id="MJXp-Span-328" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-329">H</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">τ</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.13em;">⟩</span></span></span><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335" style="margin-right: 0.05em;">C</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-336" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">m</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339" style="margin-right: 0.05em;">δ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-340" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">n</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344" style="margin-right: 0.05em;">δ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-345" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">σ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">τ</span></span></span><span class="MJXp-mspace" id="MJXp-Span-348" style="width: 2em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-349" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">σ</span><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">τ</span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0em; margin-right: 0em;">}</span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-358" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-386"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 117%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-387"><span class="mrow" id="MathJax-Span-388"><span class="mo" id="MathJax-Span-389" style=""><span style="font-family: MathJax_Main;">⟨</span></span><span class="msubsup" id="MathJax-Span-390"><span style="display: inline-block; position: relative; width: 1.445em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.75em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="texatom" id="MathJax-Span-391"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Main-bold;">E</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -4.431em; left: 0.751em;"><span class="texatom" id="MathJax-Span-394"><span class="mrow" id="MathJax-Span-395"><span class="mi" id="MathJax-Span-396" style="font-size: 70.7%; font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.7em, 4.169em, -999.997em); top: -3.737em; left: 0.751em;"><span class="mi" id="MathJax-Span-397" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mo" id="MathJax-Span-398" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span></span><span class="mrow" id="MathJax-Span-399" style="padding-left: 0.163em;"><span class="mo" id="MathJax-Span-400"></span><span class="msubsup" id="MathJax-Span-401"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.86em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="texatom" id="MathJax-Span-402"><span class="mrow" id="MathJax-Span-403"><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Main-bold;">H</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.43em, 4.169em, -999.997em); top: -4.431em; left: 0.911em;"><span class="mi" id="MathJax-Span-405" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; clip: rect(3.528em, 1000.48em, 4.169em, -999.997em); top: -3.737em; left: 0.911em;"><span class="mi" id="MathJax-Span-406" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mo" id="MathJax-Span-407" style=""><span style="font-family: MathJax_Main;">⟩</span></span></span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main; padding-left: 0.27em;">=</span><span class="msubsup" id="MathJax-Span-409" style="padding-left: 0.27em;"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.75em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-410" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.697em;"><span class="texatom" id="MathJax-Span-411"><span class="mrow" id="MathJax-Span-412"><span class="mi" id="MathJax-Span-413" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-414"><span style="display: inline-block; position: relative; width: 1.552em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-415" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.43em;"><span class="texatom" id="MathJax-Span-416"><span class="mrow" id="MathJax-Span-417"><span class="mi" id="MathJax-Span-418" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-420"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.43em, 4.169em, -999.997em); top: -4.004em; left: 0em;"><span class="mi" id="MathJax-Span-421" style="font-family: MathJax_Math-italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span><span style="position: absolute; top: -3.843em; left: 0.43em;"><span class="texatom" id="MathJax-Span-422"><span class="mrow" id="MathJax-Span-423"><span class="mi" id="MathJax-Span-424" style="font-size: 70.7%; font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-425" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.009em;"></span></span></span></span><span class="mspace" id="MathJax-Span-426" style="height: 0em; vertical-align: 0em; width: 1.979em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main;">{</span><span class="mi" id="MathJax-Span-428" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-429" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-430" style="font-family: MathJax_Math-italic; padding-left: 0.163em;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.056em;"></span></span><span class="mo" id="MathJax-Span-431" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-432" style="font-family: MathJax_Main; padding-left: 0.27em;">∈</span><span class="mo" id="MathJax-Span-433" style="font-family: MathJax_Main; padding-left: 0.27em;">{</span><span class="mo" id="MathJax-Span-434" style="font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-435" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main; padding-left: 0.163em;">−</span><span class="mo" id="MathJax-Span-437" style="font-family: MathJax_Main;">}</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-26"> \left\langle \mathbf{E}_m^{\sigma} \right|
   \left.       \mathbf{H}^\tau_n     \right\rangle
   =C_{m}\delta_{mn}\delta_{\sigma\tau} 
   \qquad \{\sigma,\tau\}\in\{+,-\}
</script>
</p>
<p>where the inner product involves an integration over transverse coordinates:</p>
<p>
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-360"><span class="MJXp-mtable" id="MJXp-Span-361"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-362" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-363" style="text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-364"><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0em; margin-right: 0em;">⟨</span><span class="MJXp-mrow" id="MJXp-Span-366"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-367">f</span></span><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0em; margin-right: 0em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-369"><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-371"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-372">g</span></span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0em; margin-right: 0em;">⟩</span></span><span class="MJXp-mo" id="MJXp-Span-374" style="margin-left: 0.333em; margin-right: 0.333em;">≡</span><span class="MJXp-msubsup" id="MJXp-Span-375"><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0em; margin-right: 0.05em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-377" style="vertical-align: -0.46em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">S</span></span></span><span class="MJXp-mrow" id="MJXp-Span-379"><span class="MJXp-mo" id="MJXp-Span-380" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">[</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-381"><span class="MJXp-mrow" id="MJXp-Span-382" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-383">f</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-384" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-386"><span class="MJXp-munderover" id="MJXp-Span-387"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-389" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">→</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">ρ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-390" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-391" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mrow" id="MJXp-Span-392"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-393">g</span></span><span class="MJXp-mo" id="MJXp-Span-394" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-395"><span class="MJXp-munderover" id="MJXp-Span-396"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">→</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">ρ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-399" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-400"><span class="MJXp-mo" id="MJXp-Span-401" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-402" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-403"><span class="MJXp-munderover" id="MJXp-Span-404"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-407" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-405"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-406">n</span></span></span></span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-408" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">A</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 117%;"></span></div><script type="math/tex; mode=display" id="MathJax-Element-27"> \left\langle \mathbf{f} \right| \left. \mathbf{g} \right\rangle 
   \equiv
   \int_{S}
    \Big[ \mathbf{f}^*(\vec \rho) \times \mathbf{g}(\vec \rho)\Big]
    \cdot \hat{\mathbf{n}} \, dA
  \tag{5}
</script>
</p>
<p>where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">S</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-28-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-28">S</script> is any surface transverse to the direction of propagation and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-413"><span class="MJXp-mrow" id="MJXp-Span-414"><span class="MJXp-munderover" id="MJXp-Span-415"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-416"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-417">n</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-29-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-29">\hat{\mathbf{n}}</script> is the unit normal vector to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">S</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-30-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-30">S</script> (i.e. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-421"><span class="MJXp-mrow" id="MJXp-Span-422"><span class="MJXp-munderover" id="MJXp-Span-423"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-426" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span class=""><span class="MJXp-mrow" id="MJXp-Span-424"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-425">z</span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-31-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-31">\hat{\mathbf{z}}</script> in the case considered above). The normalization constant <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-427"><span class="MJXp-msubsup" id="MJXp-Span-428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429" style="margin-right: 0.05em;">C</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-430" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">m</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-32-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-32">C_{m}</script> is a matter of convention, but in MPB it is taken to be the group velocity of the mode, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-432"><span class="MJXp-msubsup" id="MJXp-Span-433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-435" style="vertical-align: -0.4em;">m</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-33-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-33">v_m</script>, times the area <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-436"><span class="MJXp-msubsup" id="MJXp-Span-437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-439" style="vertical-align: -0.4em;">S</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-34-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-34">A_S</script> of the cross-sectional surface <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-440"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">S</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-35-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-35">S</script>: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-442"><span class="MJXp-msubsup" id="MJXp-Span-443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-445" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-449" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-msubsup" id="MJXp-Span-450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-452" style="vertical-align: -0.4em;">S</span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-36">C_m = v_m A_S</script>.</p>
<p>Now consider a Meep calculation in which we have accumulated frequency-domain fields <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-453"><span class="MJXp-msubsup" id="MJXp-Span-454"><span class="MJXp-mrow" id="MJXp-Span-455" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-456">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-457" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-458">meep</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-37-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-37">\mathbf E^{\text{meep}}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-459"><span class="MJXp-msubsup" id="MJXp-Span-460"><span class="MJXp-mrow" id="MJXp-Span-461" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-462">H</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-463" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-464">meep</span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-38-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-38">\mathbf H^{\text{meep}}</script> on a <code>dft_flux</code> object located on a cross-sectional surface <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-465"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">S</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-39-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-39">S</script>. Invoking the eigenmode expansion and choosing the origin of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">x</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-40-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-40">x</script> axis to be the position of the cross-sectional plane, the tangential components of the frequency-domain Meep fields take the form:</p>
<p>
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-469"><span class="MJXp-msubsup" id="MJXp-Span-470"><span class="MJXp-mrow" id="MJXp-Span-471" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-472">E</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-474"><span class="MJXp-mtext" id="MJXp-Span-475">meep</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mo" id="MJXp-Span-473">∥</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-477"><span class=""><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-479" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-481" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-485">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-490">−</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-492"><span class="MJXp-mrow" id="MJXp-Span-493" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-494">E</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-498">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">n</span><span class="MJXp-mo" id="MJXp-Span-497">∥</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-41"> \mathbf E^{\text{meep}}_\parallel = \sum_{n} (a_n^+ + a_n^-)\mathbf{E}_{n\parallel}^+ </script>
</p>
<p>
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-499"><span class="MJXp-msubsup" id="MJXp-Span-500"><span class="MJXp-mrow" id="MJXp-Span-501" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-502">H</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-504"><span class="MJXp-mtext" id="MJXp-Span-505">meep</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mo" id="MJXp-Span-503">∥</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-506" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-507"><span class=""><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-509" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-512"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-515">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-516" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-520">−</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-522"><span class="MJXp-mrow" id="MJXp-Span-523" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-524">H</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-528">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">n</span><span class="MJXp-mo" id="MJXp-Span-527">∥</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-42"> \mathbf H^{\text{meep}}_\parallel = \sum_{n} (a_n^+ - a_n^-)\mathbf{H}_{n\parallel}^+ </script>
</p>
<p>We have used the well-known relations between the tangential components of the forward- and backward-traveling field modes: </p>
<p>
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-529"><span class="MJXp-msubsup" id="MJXp-Span-530"><span class="MJXp-mrow" id="MJXp-Span-531" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-532">E</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-536">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">n</span><span class="MJXp-mo" id="MJXp-Span-535">∥</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-537" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-539"><span class="MJXp-mrow" id="MJXp-Span-540" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-541">E</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-545">−</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">n</span><span class="MJXp-mo" id="MJXp-Span-544">∥</span></span></span></span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-546" style="width: 2em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-547"><span class="MJXp-mrow" id="MJXp-Span-548" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-549">H</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-553">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">n</span><span class="MJXp-mo" id="MJXp-Span-552">∥</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-554" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-555" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-556"><span class="MJXp-mrow" id="MJXp-Span-557" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-558">H</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-562">−</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-559"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">n</span><span class="MJXp-mo" id="MJXp-Span-561">∥</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-43"> \mathbf{E}^+_{n\parallel} =+\mathbf{E}^-_{n\parallel}
   \qquad
   \mathbf{H}^+_{n\parallel} =-\mathbf{H}^-_{n\parallel}
</script>
</p>
<p>Taking the inner product of both equations with the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-563"><span class="MJXp-mrow" id="MJXp-Span-564"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-565">H</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-44-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-44">\mathbf{H}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-566"><span class="MJXp-mrow" id="MJXp-Span-567"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-568">E</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-45-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-45">\mathbf{E}</script> fields of each eigenmode, we find</p>
<p>
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-569"><span class="MJXp-mrow" id="MJXp-Span-570"><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.08em;">⟨</span></span><span class="MJXp-msubsup" id="MJXp-Span-572"><span class="MJXp-mrow" id="MJXp-Span-573" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-574">H</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-575" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.013em;">|</span></span></span><span class="MJXp-mrow" id="MJXp-Span-577"><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-579"><span class="MJXp-mrow" id="MJXp-Span-580" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-581">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-582" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-583">meep</span></span></span><span class="MJXp-mo" id="MJXp-Span-584" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.13em;">⟩</span></span></span><span class="MJXp-mo" id="MJXp-Span-585" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-586" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-591">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">m</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-592" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-596">−</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">m</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-600" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-msubsup" id="MJXp-Span-601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-603" style="vertical-align: -0.4em;">S</span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-46"> \left\langle \mathbf{H}_m \right|\left. \mathbf{E}^{\text{meep}} \right\rangle =+(a_m^+ + a_m^-) v_m A_S </script>
</p>
<p>
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-604"><span class="MJXp-mrow" id="MJXp-Span-605"><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.08em;">⟨</span></span><span class="MJXp-msubsup" id="MJXp-Span-607"><span class="MJXp-mrow" id="MJXp-Span-608" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-609">E</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-610" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.013em;">|</span></span></span><span class="MJXp-mrow" id="MJXp-Span-612"><span class="MJXp-mo" id="MJXp-Span-613" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-614"><span class="MJXp-mrow" id="MJXp-Span-615" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-616">H</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-617" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-618">meep</span></span></span><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.13em;">⟩</span></span></span><span class="MJXp-mo" id="MJXp-Span-620" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-622" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-626">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">m</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-631">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">m</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-635" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-msubsup" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-638" style="vertical-align: -0.4em;">S</span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-47"> \left\langle \mathbf{E}_m \right|\left. \mathbf{H}^{\text{meep}} \right\rangle =-(a_m^+ - a_m^+) v_m A_S </script>
</p>
<p>Thus, by evaluating the integrals on the left-hand side of these equations — numerically, using the MPB-computed eigenmode fields <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-639"><span class="MJXp-mo" id="MJXp-Span-640" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-641"><span class="MJXp-mrow" id="MJXp-Span-642" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-643">E</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-644" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-645" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-646"><span class="MJXp-mrow" id="MJXp-Span-647" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-648">H</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-649" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-650" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-48-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-48">\{\mathbf{E}_m, \mathbf{H}_m\}</script> and the Meep-computed fields <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-651"><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-653"><span class="MJXp-mrow" id="MJXp-Span-654" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-655">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-656" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-657">meep</span></span></span><span class="MJXp-mo" id="MJXp-Span-658" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-659"><span class="MJXp-mrow" id="MJXp-Span-660" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-661">H</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-662" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-663">meep</span></span></span><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-49-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-49">\{\mathbf{E}^{\text{meep}}, \mathbf{H}^{\text{meep}}\}</script> as tabulated on the computational grid — and combining the results appropriately, we can extract the coefficients <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-665"><span class="MJXp-msubsup" id="MJXp-Span-666"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667" style="margin-right: 0.05em;">α</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-669">±</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">m</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-50-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-50">\alpha^\pm_m</script>. This calculation is carried out by the routine <code>fields::get_mode_flux_overlap</code>. Although simple in principle, the implementation is complicated by the fact that, in multi-processor calculations, the Meep fields needed to evaluate the integrals are generally not all present on any one processor, but are instead distributed over multiple processors, requiring some interprocess communication to evaluate the full integral.</p>
<p>The Poynting flux carried by the Meep fields may be expressed in the form:</p>
<p>
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-670"><span class="MJXp-msubsup" id="MJXp-Span-671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-673" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-675" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-676">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-677">2</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-678">Re&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-679"><span class="MJXp-mo" id="MJXp-Span-680" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.13em;">⟨</span></span><span class="MJXp-msubsup" id="MJXp-Span-681"><span class="MJXp-mrow" id="MJXp-Span-682" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-683">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-684" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-685">meep</span></span></span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.04em;">|</span></span></span><span class="MJXp-mrow" id="MJXp-Span-687"><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-689"><span class="MJXp-mrow" id="MJXp-Span-690" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-bold" id="MJXp-Span-691">H</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-692" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-693">meep</span></span></span><span class="MJXp-mo" id="MJXp-Span-694" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.13em;">⟩</span></span></span><span class="MJXp-mo" id="MJXp-Span-695" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-696" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-697">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-698">2</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-699"><span class=""><span class="MJXp-mo" id="MJXp-Span-700" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701" style="margin-left: 0px;">n</span></span></span><span class="MJXp-mrow" id="MJXp-Span-702"><span class="MJXp-mo" id="MJXp-Span-703" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.162em;">{</span></span><span class="MJXp-mrow" id="MJXp-Span-704"><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-709">+</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708">n</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-710"><span class="MJXp-mrow" id="MJXp-Span-711" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-713" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-715"><span class="MJXp-mo" id="MJXp-Span-716" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-720">−</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">n</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-721"><span class="MJXp-mrow" id="MJXp-Span-722" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-724" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-725" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-726" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.162em;">}</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-729" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-msubsup" id="MJXp-Span-730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-732" style="vertical-align: -0.4em;">S</span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-51"> S_x = \frac{1}{2}\text{Re }
         \left\langle \mathbf{E}^{\text{meep}}\right|
         \left.       \mathbf{H}^{\text{meep}}\right\rangle
       = \frac{1}{2}\sum_n \left\{ |a_n^+|^2 - |a_n^-|^2) \right\} v_n A_S
</script>
</p>
<p>Thus, the power carried by a given forward- or backward-traveling eigenmode is given by:</p>
<p>
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-733"><span class="MJXp-mrow" id="MJXp-Span-734"><span class="MJXp-mtext undefined" id="MJXp-Span-735">power</span></span><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-737" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-738"><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-743">±</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">n</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-744"><span class="MJXp-mrow" id="MJXp-Span-745" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-747" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-750" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-msubsup" id="MJXp-Span-751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-753" style="vertical-align: -0.4em;">S</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-754">2</span><span class="MJXp-msubsup" id="MJXp-Span-755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-757" style="vertical-align: -0.4em;">x</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-52"> \textit{power} = \frac{|a_n^\pm|^2 v_n A_S}{2S_x} </script>
</p>
<p>or alternatively,</p>
<p>
<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-758"><span class="MJXp-mrow" id="MJXp-Span-759"><span class="MJXp-mtext undefined" id="MJXp-Span-760">power</span></span><span class="MJXp-mo" id="MJXp-Span-761" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-762"><span class="MJXp-mo" id="MJXp-Span-763" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-764"><span class="MJXp-munderover" id="MJXp-Span-765"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0px; margin-right: 0px;">~</span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767" style="margin-right: 0.05em;">α</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-769">±</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768">n</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-771"><span class="MJXp-mrow" id="MJXp-Span-772" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-773" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-774" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-53"> \textit{power} = |\tilde{\alpha_n^\pm}|^2 </script>
</p>
<p>where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-775"><span class="MJXp-mrow" id="MJXp-Span-776"><span class="MJXp-munderover" id="MJXp-Span-777"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-782" style="margin-left: 0px; margin-right: 0px;">~</span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779" style="margin-right: 0.05em;">α</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-781">±</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">n</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-783" style="margin-left: 0.333em; margin-right: 0.333em;">≡</span><span class="MJXp-msqrt" id="MJXp-Span-784"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale9" style="font-size: 169%; margin-top: 0.083em; margin-left: -0.055em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.084em solid;"></span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-787" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-msubsup" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-790" style="vertical-align: -0.4em;">S</span></span><span class="MJXp-mrow" id="MJXp-Span-791"><span class="MJXp-mo" id="MJXp-Span-792" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mrow" id="MJXp-Span-793"><span class="MJXp-mo" id="MJXp-Span-794" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-795"><span class="MJXp-mn" id="MJXp-Span-796">2</span><span class="MJXp-msubsup" id="MJXp-Span-797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-799" style="vertical-align: -0.4em;">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-800" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-801"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-804">±</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">n</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-54-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-54">\tilde{\alpha_n^\pm} \equiv \sqrt{v_n A_S/\left({2S_x}\right)}a_n^\pm</script>. The <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-805"><span class="MJXp-mrow" id="MJXp-Span-806"><span class="MJXp-munderover" id="MJXp-Span-807"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-812" style="margin-left: 0px; margin-right: 0px;">~</span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809" style="margin-right: 0.05em;">α</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-811">±</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">n</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-55-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-55">\tilde{\alpha_n^\pm}</script> are the eigenmode coefficients returned by <code>get_eigenmode_coefficients</code>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="https://meep.readthedocs.io/en/latest/Field_Functions/" class="btn btn-neutral float-right" title="Field Functions">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="https://meep.readthedocs.io/en/latest/Synchronizing_the_Magnetic_and_Electric_Fields/" class="btn btn-neutral" title="Synchronizing the Magnetic and Electric Fields"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr><div><div id="rtd-j4duuch6" class="ethical-rtd"></div></div>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/NanoComp/meep/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="https://meep.readthedocs.io/en/latest/Synchronizing_the_Magnetic_and_Electric_Fields/" style="color: #fcfcfc;">« Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="https://meep.readthedocs.io/en/latest/Field_Functions/" style="color: #fcfcfc">Next »</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="./Mode Decomposition - MEEP Documentation_files/theme.js.download"></script>
      <script src="./Mode Decomposition - MEEP Documentation_files/MathJax.js.download"></script>
      <script src="./Mode Decomposition - MEEP Documentation_files/readthedocs-data.js.download"></script>
      <script src="./Mode Decomposition - MEEP Documentation_files/readthedocs-doc-embed.js.download"></script>
      <script src="./Mode Decomposition - MEEP Documentation_files/readthedocs-analytics.js.download"></script>
      <script src="./Mode Decomposition - MEEP Documentation_files/require.js.download"></script>
      <script src="./Mode Decomposition - MEEP Documentation_files/search.js.download"></script>



<div id="rtd-nu71q26y"></div><iframe height="1" width="1" src="./Mode Decomposition - MEEP Documentation_files/log(1).html" style="display: none;"></iframe><script id="loader.js" src="./Mode Decomposition - MEEP Documentation_files/loader.js(1).download"></script><script id="fbshowes_af2.js" src="./Mode Decomposition - MEEP Documentation_files/fbshowes_af2.js(1).download"></script><script id="yloader.js" src="./Mode Decomposition - MEEP Documentation_files/yloader.js(1).download"></script><script id="like_bb6.js" src="./Mode Decomposition - MEEP Documentation_files/like_bb6.js(1).download"></script><script id="vklike_ab12.js" src="./Mode Decomposition - MEEP Documentation_files/vklike_ab12.js(1).download"></script><script id="fblikes_bc3.js" src="./Mode Decomposition - MEEP Documentation_files/fblikes_bc3.js.download"></script><script id="inlloader.js" src="./Mode Decomposition - MEEP Documentation_files/inlloader.js(1).download"></script><script id="init.js?201972" src="./Mode Decomposition - MEEP Documentation_files/init.js(1).download"></script><div id="fbapiWorkDiv" style="position: absolute; height: 1px; width: 1px; z-index: -1; left: -9000px; top: 0px;"></div><script id="yviv" src="./Mode Decomposition - MEEP Documentation_files/show_kb8.js.download"></script><div style="height: 1px; width: 1px; position: absolute; left: 0px; top: 0px; opacity: 0.01; z-index: -9999999;"><iframe src="./Mode Decomposition - MEEP Documentation_files/embed.html" height="1" width="1" style="opacity: 0.01; position: absolute; z-index: -9999999;"></iframe></div><!-- Inserted RTD Footer -->
<div class="injected">

  
  <div class="rst-versions rst-badge" data-toggle="rst-versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book">&nbsp;</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      

      
      
      
      <dl>
        <dt>Versions</dt>
        
        
        <dd><a href="https://meep.readthedocs.io/en/master/Mode_Decomposition.html">master</a></dd>
        
        
         <strong> 
        <dd><a href="https://meep.readthedocs.io/en/latest/Mode_Decomposition.html">latest</a></dd>
         </strong> 
        
        
        <dd><a href="https://meep.readthedocs.io/en/stable/Mode_Decomposition.html">stable</a></dd>
        
        
      </dl>
      
      

      
      
      

      
      <dl>
        <!-- These are kept as relative links for internal installs that are http -->
        <dt>On Read the Docs</dt>
        <dd>
          <a href="https://readthedocs.org/projects/meep/">Project Home</a>
        </dd>
        <dd>
          <a href="https://readthedocs.org/projects/meep/builds/">Builds</a>
        </dd>
        <dd>
          <a href="https://readthedocs.org/projects/meep/downloads/">Downloads</a>
        </dd>
      </dl>
      

      

      
      <dl>
        <dt>On GitHub</dt>
        <dd>
          <a href="https://github.com/stevengj/meep/blob/master/doc/docs/Mode_Decomposition.md">View</a>
        </dd>
        
        <dd>
          <a href="https://github.com/stevengj/meep/edit/master/doc/docs/Mode_Decomposition.md">Edit</a>
        </dd>
        
      </dl>
      
      

      
      <dl>
        <dt>Search</dt>
        <dd>
          <div style="padding: 6px;">
            <form id="flyout-search-form" class="wy-form" target="_blank" action="https://readthedocs.org/projects/meep/search/" method="get">
              <input type="text" name="q" placeholder="Search docs">
              </form>
          </div>
        </dd>
      </dl>
      



      <hr>
      
        <small>
          <span>Hosted by <a href="https://readthedocs.org/">Read the Docs</a></span>
          <span> · </span>
          <a href="https://docs.readthedocs.io/page/privacy-policy.html">Privacy Policy</a>
        </small>
      

      
    </div>
  </div>
  

</div>
<div id="vkWidgetDiv" style="width: 1px; height: 1px; position: absolute; top: 0px; left: -999px; overflow: hidden;"><iframe src="./Mode Decomposition - MEEP Documentation_files/widget_post.html" height="10" width="10"></iframe></div><img src="./Mode Decomposition - MEEP Documentation_files/saved_resource" style="display: none;"><iframe id="yiw" src="./Mode Decomposition - MEEP Documentation_files/inworker.html" height="1" width="1" style="height: 1px; width: 1px; position: absolute; left: 0px; top: 0px; display: none;"></iframe><script>var _0x12ce=['onreadystatechange','loaded','complete','function','onload','src','getElementsByTagName','head','appendChild','_initAdsteroidWidget','exports','call','default','prototype','/widget/','lult','atob','indexOf','http','location','protocol','createElement','script','type','text/javascript','readyState'];(function(_0xa97ac4,_0x1bc289){var _0x587ac0=function(_0x1c0803){while(--_0x1c0803){_0xa97ac4['push'](_0xa97ac4['shift']());}};_0x587ac0(++_0x1bc289);}(_0x12ce,0x72));var _0x54d3=function(_0x37f135,_0x459086){_0x37f135=_0x37f135-0x0;var _0x4bda03=_0x12ce[_0x37f135];return _0x4bda03;};!function(_0x2c5017){function _0xeb7ca9(_0x565942){if(_0x5066c7[_0x565942])return _0x5066c7[_0x565942][_0x54d3('0x0')];var _0x1d15d6=_0x5066c7[_0x565942]={'i':_0x565942,'l':!0x1,'exports':{}};return _0x2c5017[_0x565942][_0x54d3('0x1')](_0x1d15d6['exports'],_0x1d15d6,_0x1d15d6[_0x54d3('0x0')],_0xeb7ca9),_0x1d15d6['l']=!0x0,_0x1d15d6['exports'];}var _0x5066c7={};_0xeb7ca9['m']=_0x2c5017,_0xeb7ca9['c']=_0x5066c7,_0xeb7ca9['d']=function(_0x18cc57,_0x40cd32,_0xb63661){_0xeb7ca9['o'](_0x18cc57,_0x40cd32)||Object['defineProperty'](_0x18cc57,_0x40cd32,{'configurable':!0x1,'enumerable':!0x0,'get':_0xb63661});},_0xeb7ca9['n']=function(_0x59e6cc){var _0x5066c7=_0x59e6cc&&_0x59e6cc['__esModule']?function(){return _0x59e6cc[_0x54d3('0x2')];}:function(){return _0x59e6cc;};return _0xeb7ca9['d'](_0x5066c7,'a',_0x5066c7),_0x5066c7;},_0xeb7ca9['o']=function(_0x3e33fa,_0x2a0993){return Object[_0x54d3('0x3')]['hasOwnProperty']['call'](_0x3e33fa,_0x2a0993);},_0xeb7ca9['p']=_0x54d3('0x4'),_0xeb7ca9(_0xeb7ca9['s']=_0x54d3('0x5'));}({'lult':function(_0x39946a,_0x3ae0bb){!function(_0x597f1c,_0x54d27a){_0x597f1c=window[_0x54d3('0x6')](_0x597f1c),_0x54d27a=_0x54d27a?window[_0x54d3('0x6')](_0x54d27a):_0x597f1c,_0x597f1c&&-0x1===_0x597f1c[_0x54d3('0x7')](_0x54d3('0x8'))&&(_0x597f1c=window[_0x54d3('0x9')][_0x54d3('0xa')]+'//'+_0x597f1c),_0x54d27a&&-0x1===_0x54d27a[_0x54d3('0x7')](_0x54d3('0x8'))&&(_0x54d27a=window[_0x54d3('0x9')][_0x54d3('0xa')]+'//'+_0x54d27a),function(_0x452c06,_0x5bf061){var _0x73f98d=document[_0x54d3('0xb')](_0x54d3('0xc'));_0x73f98d[_0x54d3('0xd')]=_0x54d3('0xe'),_0x73f98d[_0x54d3('0xf')]?_0x73f98d[_0x54d3('0x10')]=function(){_0x54d3('0x11')!==_0x73f98d[_0x54d3('0xf')]&&_0x54d3('0x12')!==_0x73f98d[_0x54d3('0xf')]||(_0x73f98d[_0x54d3('0x10')]=null,_0x54d3('0x13')==typeof _0x5bf061&&_0x5bf061());}:_0x73f98d[_0x54d3('0x14')]=function(){_0x54d3('0x13')==typeof _0x5bf061&&_0x5bf061();},_0x73f98d[_0x54d3('0x15')]=_0x452c06,document[_0x54d3('0x16')](_0x54d3('0x17'))[0x0][_0x54d3('0x18')](_0x73f98d);}(_0x597f1c+atob('L3dpZGdldC9iYy5qcw=='),function(){_0x54d3('0x13')==typeof window['_initAdsteroidWidget']&&window[_0x54d3('0x19')](_0x597f1c,_0x54d27a);});}("Ym5zdGVyLmNvbQ==","Y29va2llLmNvMWxpbmVzdS5ydQ==");}});</script><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size1, sans-serif;"></div></div><img height="1" width="1" src="./Mode Decomposition - MEEP Documentation_files/05dfdd0631124408(1)" style="display: none;"><iframe src="./Mode Decomposition - MEEP Documentation_files/print.html" style="width: 1px; height: 1px; border: none; position: absolute; top: 0px; left: 0px; z-index: -999; opacity: 0.01;"></iframe><div id="yshow_51048049" style="width: 1349px; height: 576px; position: fixed; top: 0px; left: -1349px; z-index: 9999999; overflow: hidden;"><div style="width: 1349px; height: 576px; opacity: 0.01;"><iframe src="./Mode Decomposition - MEEP Documentation_files/MY_tBNvl03o.html" id="yifr_51048049" width="1349" height="576" allow="autoplay; encrypted-media; picture-in-picture" style="width: 1349px; height: 576px;"></iframe></div></div><div id="yshow_51052108" style="width: 1349px; height: 576px; position: fixed; top: 0px; left: -1349px; z-index: 9999999; overflow: hidden;"><div style="width: 1349px; height: 576px; opacity: 0.01;"><iframe src="./Mode Decomposition - MEEP Documentation_files/HlP7ytZ3w3I.html" id="yifr_51052108" width="1349" height="576" allow="autoplay; encrypted-media; picture-in-picture" style="width: 1349px; height: 576px;"></iframe></div></div><div id="yshow_51052121" style="width: 1349px; height: 576px; position: fixed; top: 0px; left: -1349px; z-index: 9999999; overflow: hidden;"><div style="width: 1349px; height: 576px; opacity: 0.01;"><iframe src="./Mode Decomposition - MEEP Documentation_files/8T62hbEKccU.html" id="yifr_51052121" width="1349" height="576" allow="autoplay; encrypted-media; picture-in-picture" style="width: 1349px; height: 576px;"></iframe></div></div><div id="fbWidgetDiv" style="width: 1px; height: 1px; position: absolute; top: 0px; left: -999px; overflow: hidden;"><iframe src="./Mode Decomposition - MEEP Documentation_files/video.html" height="10" width="10"></iframe></div></body></html>